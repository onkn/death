title: Ngrok Tunnel Creation
id: 6a5b4c3d-2e1f-4a9b-8c7d-6e5f4a3b2c1d
status: experimental
description: Detects ngrok being used to create tunnels, which can provide external access paths into internal systems.
references:
    - https://www.huntress.com/blog/abusing-ngrok-hackers-at-the-end-of-the-tunnel
author: Onni Knuutila
date: 2025-12-17
tags:
    - attack.command-and-control
    - attack.t1090
logsource:
    product: windows
    category: process_creation
detection:
    selection_img:
        Image|endswith: '\ngrok.exe'
    selection_cmd:
        CommandLine|contains:
            - 'http'
            - 'tcp'
            - 'start'
            - 'config add-authtoken'
    condition: selection_img and selection_cmd
falsepositives:
    - Developers legitimately using ngrok.
level: medium
