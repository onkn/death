title: UAC Bypass via WSReset Registry Hijack
id: 1f3b7c2d-1b7a-4e8c-9a38-6c8a0f8b2d7e
status: experimental
description: Detects WSReset UAC bypass behavior by monitoring execution of wsreset.exe and registry modification patterns.
references:
    - https://www.atomicredteam.io/atomic-red-team/atomics/T1548.002
    - https://lolbas-project.github.io/lolbas/Binaries/Wsreset/
author: Onni Knuutila
date: 2025-12-16
tags:
    - attack.privilege-escalation
    - attack.defense-evasion
    - attack.t1548.002
logsource:
    product: windows
    category: process_creation
detection:
    selection_wsreset:
        Image|endswith: '\wsreset.exe'
    selection_registry_tooling:
        Image|endswith:
            - '\cmd.exe'
            - '\reg.exe'
            - '\powershell.exe'
            - '\pwsh.exe'
    selection_hijack_path:
        CommandLine|contains:
            - 'HKCU\Software\Classes\AppX'
            - 'HKCU\SOFTWARE\Classes\AppX'
            - 'Shell\open\command'
            - 'SHELL\OPEN\COMMAND'
    selection_delegateexecute:
        CommandLine|contains:
            - 'DelegateExecute'
            - 'DELEGATEEXECUTE'
    condition: selection_wsreset or (selection_registry_tooling and selection_hijack_path and selection_delegateexecute)
falsepositives:
    - Unknown
level: high
